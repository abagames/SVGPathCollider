!function(t,o){"object"==typeof exports&&"object"==typeof module?module.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==typeof exports?exports.spc=o():t.spc=o()}(window,function(){return function(t){var o={};function e(i){if(o[i])return o[i].exports;var n=o[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,e),n.l=!0,n.exports}return e.m=t,e.c=o,e.d=function(t,o,i){e.o(t,o)||Object.defineProperty(t,o,{enumerable:!0,get:i})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,o){if(1&o&&(t=e(t)),8&o)return t;if(4&o&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(e.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&o&&"string"!=typeof t)for(var n in t)e.d(i,n,function(o){return t[o]}.bind(null,n));return i},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,o){return Object.prototype.hasOwnProperty.call(t,o)},e.p="",e(e.s=1)}([function(t,o,e){var i,n;
/** @preserve SAT.js - Version 0.7.1 - Copyright 2012 - 2018 - Jim Riecken <jimr@jimr.ca> - released under the MIT License. https://github.com/jriecken/sat-js */
/** @preserve SAT.js - Version 0.7.1 - Copyright 2012 - 2018 - Jim Riecken <jimr@jimr.ca> - released under the MIT License. https://github.com/jriecken/sat-js */
!function(s,r){"use strict";void 0===(n="function"==typeof(i=function(){var t={};function o(t,o){this.x=t||0,this.y=o||0}function e(t,e){this.pos=t||new o,this.r=e||0}function i(t,e){this.pos=t||new o,this.angle=0,this.offset=new o,this.setPoints(e||[])}function n(t,e,i){this.pos=t||new o,this.w=e||0,this.h=i||0}function s(){this.a=null,this.b=null,this.overlapN=new o,this.overlapV=new o,this.clear()}t.Vector=o,t.V=o,o.prototype.copy=o.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},o.prototype.clone=o.prototype.clone=function(){return new o(this.x,this.y)},o.prototype.perp=o.prototype.perp=function(){var t=this.x;return this.x=this.y,this.y=-t,this},o.prototype.rotate=o.prototype.rotate=function(t){var o=this.x,e=this.y;return this.x=o*Math.cos(t)-e*Math.sin(t),this.y=o*Math.sin(t)+e*Math.cos(t),this},o.prototype.reverse=o.prototype.reverse=function(){return this.x=-this.x,this.y=-this.y,this},o.prototype.normalize=o.prototype.normalize=function(){var t=this.len();return t>0&&(this.x=this.x/t,this.y=this.y/t),this},o.prototype.add=o.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},o.prototype.sub=o.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},o.prototype.scale=o.prototype.scale=function(t,o){return this.x*=t,this.y*=void 0!==o?o:t,this},o.prototype.project=o.prototype.project=function(t){var o=this.dot(t)/t.len2();return this.x=o*t.x,this.y=o*t.y,this},o.prototype.projectN=o.prototype.projectN=function(t){var o=this.dot(t);return this.x=o*t.x,this.y=o*t.y,this},o.prototype.reflect=o.prototype.reflect=function(t){var o=this.x,e=this.y;return this.project(t).scale(2),this.x-=o,this.y-=e,this},o.prototype.reflectN=o.prototype.reflectN=function(t){var o=this.x,e=this.y;return this.projectN(t).scale(2),this.x-=o,this.y-=e,this},o.prototype.dot=o.prototype.dot=function(t){return this.x*t.x+this.y*t.y},o.prototype.len2=o.prototype.len2=function(){return this.dot(this)},o.prototype.len=o.prototype.len=function(){return Math.sqrt(this.len2())},t.Circle=e,e.prototype.getAABB=e.prototype.getAABB=function(){var t=this.r,e=this.pos.clone().sub(new o(t,t));return new n(e,2*t,2*t).toPolygon()},t.Polygon=i,i.prototype.setPoints=i.prototype.setPoints=function(t){var e=!this.points||this.points.length!==t.length;if(e){var i,n=this.calcPoints=[],s=this.edges=[],r=this.normals=[];for(i=0;i<t.length;i++)n.push(new o),s.push(new o),r.push(new o)}return this.points=t,this._recalc(),this},i.prototype.setAngle=i.prototype.setAngle=function(t){return this.angle=t,this._recalc(),this},i.prototype.setOffset=i.prototype.setOffset=function(t){return this.offset=t,this._recalc(),this},i.prototype.rotate=i.prototype.rotate=function(t){for(var o=this.points,e=o.length,i=0;i<e;i++)o[i].rotate(t);return this._recalc(),this},i.prototype.translate=i.prototype.translate=function(t,o){for(var e=this.points,i=e.length,n=0;n<i;n++)e[n].x+=t,e[n].y+=o;return this._recalc(),this},i.prototype._recalc=function(){var t,o=this.calcPoints,e=this.edges,i=this.normals,n=this.points,s=this.offset,r=this.angle,h=n.length;for(t=0;t<h;t++){var p=o[t].copy(n[t]);p.x+=s.x,p.y+=s.y,0!==r&&p.rotate(r)}for(t=0;t<h;t++){var l=o[t],a=t<h-1?o[t+1]:o[0],u=e[t].copy(a).sub(l);i[t].copy(u).perp().normalize()}return this},i.prototype.getAABB=i.prototype.getAABB=function(){for(var t=this.calcPoints,e=t.length,i=t[0].x,s=t[0].y,r=t[0].x,h=t[0].y,p=1;p<e;p++){var l=t[p];l.x<i?i=l.x:l.x>r&&(r=l.x),l.y<s?s=l.y:l.y>h&&(h=l.y)}return new n(this.pos.clone().add(new o(i,s)),r-i,h-s).toPolygon()},i.prototype.getCentroid=i.prototype.getCentroid=function(){for(var t=this.calcPoints,e=t.length,i=0,n=0,s=0,r=0;r<e;r++){var h=t[r],p=r===e-1?t[0]:t[r+1],l=h.x*p.y-p.x*h.y;i+=(h.x+p.x)*l,n+=(h.y+p.y)*l,s+=l}return new o(i/=s*=3,n/=s)},t.Box=n,n.prototype.toPolygon=n.prototype.toPolygon=function(){var t=this.pos,e=this.w,n=this.h;return new i(new o(t.x,t.y),[new o,new o(e,0),new o(e,n),new o(0,n)])},t.Response=s,s.prototype.clear=s.prototype.clear=function(){return this.aInB=!0,this.bInA=!0,this.overlap=Number.MAX_VALUE,this};for(var r=[],h=0;h<10;h++)r.push(new o);for(var p=[],h=0;h<5;h++)p.push([]);var l=new s,a=new n(new o,1e-6,1e-6).toPolygon();function u(t,o,e){for(var i=Number.MAX_VALUE,n=-Number.MAX_VALUE,s=t.length,r=0;r<s;r++){var h=t[r].dot(o);h<i&&(i=h),h>n&&(n=h)}e[0]=i,e[1]=n}function c(t,o,e,i,n,s){var h=p.pop(),l=p.pop(),a=r.pop().copy(o).sub(t),c=a.dot(n);if(u(e,n,h),u(i,n,l),l[0]+=c,l[1]+=c,h[0]>l[1]||l[0]>h[1])return r.push(a),p.push(h),p.push(l),!0;if(s){var y=0;if(h[0]<l[0])if(s.aInB=!1,h[1]<l[1])y=h[1]-l[0],s.bInA=!1;else{var g=h[1]-l[0],f=l[1]-h[0];y=g<f?g:-f}else if(s.bInA=!1,h[1]>l[1])y=h[0]-l[1],s.aInB=!1;else{var g=h[1]-l[0],f=l[1]-h[0];y=g<f?g:-f}var d=Math.abs(y);d<s.overlap&&(s.overlap=d,s.overlapN.copy(n),y<0&&s.overlapN.reverse())}return r.push(a),p.push(h),p.push(l),!1}function y(t,o){var e=t.len2(),i=o.dot(t);return i<0?g:i>e?d:f}t.isSeparatingAxis=c;var g=-1,f=0,d=1;function v(t,o,e){for(var i=r.pop().copy(o.pos).sub(t.pos),n=o.r,s=n*n,h=t.calcPoints,p=h.length,l=r.pop(),a=r.pop(),u=0;u<p;u++){var c=u===p-1?0:u+1,f=0===u?p-1:u-1,v=0,x=null;l.copy(t.edges[u]),a.copy(i).sub(h[u]),e&&a.len2()>s&&(e.aInB=!1);var b=y(l,a);if(b===g){l.copy(t.edges[f]);var B=r.pop().copy(i).sub(h[f]);if((b=y(l,B))===d){var A=a.len();if(A>n)return r.push(i),r.push(l),r.push(a),r.push(B),!1;e&&(e.bInA=!1,x=a.normalize(),v=n-A)}r.push(B)}else if(b===d){if(l.copy(t.edges[c]),a.copy(i).sub(h[c]),(b=y(l,a))===g){var A=a.len();if(A>n)return r.push(i),r.push(l),r.push(a),!1;e&&(e.bInA=!1,x=a.normalize(),v=n-A)}}else{var P=l.perp().normalize(),A=a.dot(P),w=Math.abs(A);if(A>0&&w>n)return r.push(i),r.push(P),r.push(a),!1;e&&(x=P,v=n-A,(A>=0||v<2*n)&&(e.bInA=!1))}x&&e&&Math.abs(v)<Math.abs(e.overlap)&&(e.overlap=v,e.overlapN.copy(x))}return e&&(e.a=t,e.b=o,e.overlapV.copy(e.overlapN).scale(e.overlap)),r.push(i),r.push(l),r.push(a),!0}function x(t,o,e){for(var i=t.calcPoints,n=i.length,s=o.calcPoints,r=s.length,h=0;h<n;h++)if(c(t.pos,o.pos,i,s,t.normals[h],e))return!1;for(var h=0;h<r;h++)if(c(t.pos,o.pos,i,s,o.normals[h],e))return!1;return e&&(e.a=t,e.b=o,e.overlapV.copy(e.overlapN).scale(e.overlap)),!0}return t.pointInCircle=function(t,o){var e=r.pop().copy(t).sub(o.pos),i=o.r*o.r,n=e.len2();return r.push(e),n<=i},t.pointInPolygon=function(t,o){a.pos.copy(t),l.clear();var e=x(a,o,l);return e&&(e=l.aInB),e},t.testCircleCircle=function(t,o,e){var i=r.pop().copy(o.pos).sub(t.pos),n=t.r+o.r,s=n*n,h=i.len2();if(h>s)return r.push(i),!1;if(e){var p=Math.sqrt(h);e.a=t,e.b=o,e.overlap=n-p,e.overlapN.copy(i.normalize()),e.overlapV.copy(i).scale(e.overlap),e.aInB=t.r<=o.r&&p<=o.r-t.r,e.bInA=o.r<=t.r&&p<=t.r-o.r}return r.push(i),!0},t.testPolygonCircle=v,t.testCirclePolygon=function(t,o,e){var i=v(o,t,e);if(i&&e){var n=e.a,s=e.aInB;e.overlapN.reverse(),e.overlapV.reverse(),e.a=e.b,e.b=n,e.aInB=e.bInA,e.bInA=s}return i},t.testPolygonPolygon=x,t})?i.call(o,e,o,t):i)||(t.exports=n)}()},function(t,o,e){"use strict";Object.defineProperty(o,"__esModule",{value:!0});const i=e(0);o.default=class{constructor(t,o=16,e=!1){this.path=t,this.separationNum=o,this.isConcave=e,this.shouldBeUpdatingBoundingBox=!0,this.boundingBox=new i.Polygon,this.shouldBeUpdatingCollisionArea=!0,this.isShowingCollision=!1,this.boundingBoxSvg=null,this.collisionAreaSvg=null,this.isBoundingBoxColliding=!1,this.boundingBox=new i.Polygon(new i.Vector,this.times(4,()=>new i.Vector)),this.collisionArea=new i.Polygon(new i.Vector,this.times(o,()=>new i.Vector));var n=t.ownerSVGElement;this.boundingPoints=this.times(4,()=>n.createSVGPoint()),e&&(this.concaveCollisionAreas=this.times(o,()=>new i.Polygon(new i.Vector,this.times(3,()=>new i.Vector))))}update(){if(this.shouldBeUpdatingBoundingBox=!0,this.shouldBeUpdatingCollisionArea=!0,this.isShowingCollision){var t=this.isBoundingBoxColliding?"visible":"hidden";this.collisionAreaSvg.setAttribute("visibility",t)}this.isBoundingBoxColliding=!1}test(t){return this.updateBoundingBox(),t.updateBoundingBox(),!!i.testPolygonPolygon(this.boundingBox,t.boundingBox)&&(this.isBoundingBoxColliding=!0,t.isBoundingBoxColliding=!0,this.updateCollisionArea(),t.updateCollisionArea(),this.isConcave?this.concaveCollisionAreas.some(o=>t.testToPolygon(o)):t.testToPolygon(this.collisionArea))}showCollision(t=!0){this.isShowingCollision=t;var o=this.path.ownerSVGElement;null!=this.boundingBoxSvg&&(o.removeChild(this.boundingBoxSvg),this.boundingBoxSvg=null),null!=this.collisionAreaSvg&&(o.removeChild(this.collisionAreaSvg),this.collisionAreaSvg=null),this.isShowingCollision&&(this.boundingBoxSvg=this.createPath(),o.appendChild(this.boundingBoxSvg),this.collisionAreaSvg=this.createPath(2,5),o.appendChild(this.collisionAreaSvg))}updateBoundingBox(){this.shouldBeUpdatingBoundingBox&&(this.shouldBeUpdatingBoundingBox=!1,this.pathToBoundingBox(this.path,this.boundingBox.points),this.boundingBox.setAngle(0),this.isShowingCollision&&this.boundingBoxSvg.setAttribute("d",this.satPolygonToPathStr(this.boundingBox)))}updateCollisionArea(){if(this.shouldBeUpdatingCollisionArea)if(this.shouldBeUpdatingCollisionArea=!1,this.pathToCollisionArea(this.path,this.collisionArea.points),this.isShowingCollision&&this.collisionAreaSvg.setAttribute("d",this.satPolygonToPathStr(this.collisionArea)),this.isConcave){var t=new i.Vector;this.collisionArea.points.forEach(o=>{t.x+=o.x,t.y+=o.y});var o=this.separationNum;t.x/=o,t.y/=o,this.times(o,e=>{var i=this.collisionArea.points[e],n=this.collisionArea.points[(e+1)%o],s=this.concaveCollisionAreas[e],r=s.points;r[0].x=i.x,r[0].y=i.y,r[1].x=n.x,r[1].y=n.y,r[2].x=t.x,r[2].y=t.y,s.setAngle(0)})}else this.collisionArea.setAngle(0)}testToPolygon(t){return this.isConcave?this.concaveCollisionAreas.some(o=>i.testPolygonPolygon(o,t)):i.testPolygonPolygon(this.collisionArea,t)}pathToBoundingBox(t,o){const e=t.getBBox(),i=t.getCTM();this.boundingPoints[0].x=e.x,this.boundingPoints[0].y=e.y,this.boundingPoints[1].x=e.x+e.width,this.boundingPoints[1].y=e.y,this.boundingPoints[2].x=e.x+e.width,this.boundingPoints[2].y=e.y+e.height,this.boundingPoints[3].x=e.x,this.boundingPoints[3].y=e.y+e.height,this.boundingPoints.forEach((t,e)=>{t=t.matrixTransform(i);var n=o[e];n.x=t.x,n.y=t.y})}pathToCollisionArea(t,o){const e=t.getCTM(),i=t.getTotalLength();let n=0;o.forEach(o=>{var s=t.getPointAtLength(n).matrixTransform(e);o.x=s.x,o.y=s.y,n+=i/this.separationNum})}satPolygonToPathStr(t){let o="M";return t.points.forEach((t,e)=>{o+=`${t.x},${t.y} `}),o+="z"}createPath(t=1,o=10){const e=document.createElementNS("http://www.w3.org/2000/svg","path");return e.setAttribute("stroke","#777"),e.setAttribute("stroke-width",`${t}`),e.setAttribute("fill","none"),e.setAttribute("stroke-dasharray",`${o}`),e}times(t,o){let e=[];for(let i=0;i<t;i++)e.push(o(i));return e}}}])});